[[PageOutline]]

= GHC Repositories =

This page lists the active repositories relating to GHC. These are Git repositories, so you should learn [wiki:WorkingConventions/Git about Git] first. For instructions on actually getting a GHC source tree, see [wiki:Building/GettingTheSources Getting The Sources]. For information on using these repositories (via submodules), see [wiki:WorkingConventions/Git/Submodules the Submodules page].

== Repository listing ==

The GHC source code uses many related sub-repositories, which are needed for external dependencies during the build, or tools that are included in the build. Every single upstream repository we track is tracked with a '''git submodule''', so that for any particular GHC commit, Git's submodule mechanism makes it possible to check out exactly the right version of each sub-repository.

Some submodules are maintained by GHC HQ, and some by their parties.  You can find out by looking at the `.cabal` file.


Here is the setup in more detail:

 * '''Upstream repo'''.
   * Each submodule has an '''upstream''', or master, repository.
   * Patches to the submodule must be pushed to the upstream repo.
   * The authoritative info for the upstream URL is in the file `packages` in the root directory of the main GHC repo.
   * If the `packages` file gives an upstream URL of "-", authoritative info is in the file `.gitmodules`.

 * '''Mirror repo'''.
   * If the upstream repo is not at `git.haskell.org`, then we maintain a '''mirror''' repo at `git.haskell.org`.
   * Pulling and cloning happens from the mirror repo, so that we can build GHC without relying on lots of other machines being up.
   * The mirror should be updated from the upstream repo at least every minute or so.
   * The authoritative info for the mirror URL is in the file `.gitmodules` in the root directory of the main GHC repo.

 * '''Upstream GHC branch'''.  As GHC's HEAD moves on, between releases, there is often a need to update a library in sync.  Each library has a named branch, the '''upstream GHC branch''' to which patches can be pushed.  (See table below.)  If the library author is actively developing the library, he or she will typically do so on a different branch from the upstream GHC branch.  The typical sequence is
   * `cd libraries/parallel`
   * `git checkout master`, or whatever the "upstream GHC branch" is called.
   * Make modifications to the library
   * `git push`: push the patch (may need to ask the maintainer to do this)
   * Wait for the mirror
   * `cd ../..`: back into the GHC directory
   * `git add libraries/parallel`: record the new library commit in the main GHC repo.
   * `git push`, with a commit message mentioning the word "submodule"
   More details in [wiki:WorkingConventions/Git/Submodules the Submodules page]

Here are the submodules we use, and where their upstreams point:

{{{#!comment
On Github, but it says "WORK-IN-PROGRESS / DO NOT USE YET":
* array
* old-locale
* old-time
}}}
{{{
#!html
<table border="1">
<tr><td><strong>Location in tree</strong></td> <td><strong>Upstream repo</strong></td> <td><strong>Upstream GHC branch</strong></td> <td><strong>Installed[1]</strong></td> <td><strong>Req'd to build[2]</strong></td></tr>
<tr><td>utils/hsc2hs</td>           <td>https://git.haskell.org/hsc2hs.git</td> <td>master</td> <td>Yes</td> <td>Yes</td></tr>
<tr><td>utils/haddock</td>          <td>https://github.com/haskell/haddock</td> <td>ghc-head</td> <td>Yes</td> <td>No</td></tr>
<tr><td>nofib</td>                  <td>https://git.haskell.org/nofib.git</td> <td>master</td> <td>N/A</td> <td>N/A</td></tr>
<tr><td>libraries/array</td>        <td>https://git.haskell.org/packages/array.git</td> <td>master</td> <td>Yes</td> <td>Yes</td></tr>
<tr><td>libraries/binary</td>       <td>https://github.com/kolmodin/binary</td> <td>master</td> <td>Yes</td> <td>Yes</td></tr>
<tr><td>libraries/bytestring</td>   <td>https://github.com/haskell/bytestring</td> <td>master</td> <td>Yes</td> <td>Yes</td></tr>
<tr><td>libraries/Cabal</td>        <td>https://github.com/haskell/Cabal</td> <td>master</td> <td>Yes</td> <td>Yes</td></tr>
<tr><td>libraries/containers</td>   <td>https://github.com/haskell/containers</td> <td>master</td> <td>Yes</td> <td>Yes</td></tr>
<tr><td>libraries/deepseq</td>      <td>https://git.haskell.org/packages/deepseq.git</td> <td>master</td> <td>No</td> <td>No</td></tr>
<tr><td>libraries/directory</td>    <td>https://github.com/haskell/directory</td> <td>master</td> <td>Yes</td> <td>Yes</td></tr>
<tr><td>libraries/filepath</td>     <td>https://github.com/haskell/filepath</td> <td>master</td> <td>Yes</td> <td>Yes</td></tr>
<tr><td>libraries/haskeline</td>    <td>https://github.com/judah/haskeline</td> <td>master</td> <td>Yes</td> <td>Yes</td></tr>
<tr><td>libraries/haskell98</td>    <td>https://git.haskell.org/packages/haskell98.git</td> <td>master</td> <td>Yes</td> <td>Yes</td></tr>
<tr><td>libraries/haskell2010</td>  <td>https://git.haskell.org/packages/haskell2010.git</td> <td>master</td> <td>Yes</td> <td>Yes</td></tr>
<tr><td>libraries/hoopl</td>        <td>https://git.haskell.org/packages/hoopl.git</td> <td>master</td> <td>Yes</td> <td>Yes</td></tr>
<tr><td>libraries/hpc</td>          <td>https://git.haskell.org/packages/hpc.git</td> <td>master</td> <td>Yes</td> <td>Yes</td></tr>
<tr><td>libraries/old-locale</td>   <td>https://git.haskell.org/packages/old-locale.git</td> <td>master</td> <td>Yes</td> <td>Yes</td></tr>
<tr><td>libraries/old-time</td>     <td>https://git.haskell.org/packages/old-time.git</td> <td>master</td> <td>Yes</td> <td>Yes</td></tr>
<tr><td>libraries/process</td>      <td>https://github.com/process</td> <td>master</td> <td>Yes</td> <td>Yes</td></tr>
<tr><td>libraries/terminfo</td>     <td>https://github.com/judah/terminfo</td> <td>master</td> <td>Yes</td> <td>Yes</td></tr>
<tr><td>libraries/time</td>         <td>https://github.com/haskell/time</td> <td>master</td> <td>Yes</td> <td>Yes</td></tr>
<tr><td>libraries/unix</td>         <td>https://github.com/haskell/unix</td> <td>master</td> <td>Yes</td> <td>Yes</td></tr>
<tr><td>libraries/Win32</td>        <td>https://github.com/haskell/win32</td> <td>master</td> <td>Yes</td> <td>Yes</td></tr>
<tr><td>libraries/xhtml</td>        <td>https://github.com/haskell/xhtml</td> <td>master</td> <td>Yes</td> <td>Yes</td></tr>
<tr><td>libraries/random</td>       <td>https://github.com/haskell/random</td> <td>master</td> <td>No</td> <td>No</td></tr>
<tr><td>libraries/primitive</td>    <td>https://github.com/haskell/primitive</td> <td>master</td> <td>No</td> <td>No</td></tr>
<tr><td>libraries/vector</td>       <td>https://github.com/haskell/vector</td> <td>master</td> <td>No</td> <td>No</td></tr>
<tr><td>libraries/dph</td>          <td>https://git.haskell.org/packages/dph.git</td> <td>master</td> <td>No</td> <td>No</td></tr>
<tr><td>libraries/parallel</td>     <td>https://github.com/haskell/parallel</td> <td>master</td> <td>No</td> <td>No</td></tr>
<tr><td>libraries/stm</td>          <td>https://git.haskell.org/packages/stm.git</td> <td>master</td> <td>No</td> <td>No</td></tr>
</table>
}}}

 * ![1] These libraries are not installed in the resulting compiler when you do `make install`

 * ![2] These libraries are not required to build the compiler, but may be used for tests or other libraries. Right now, most of these are based on whether you build DPH. At the moment, DPH is turned off. To build these libraries, set `BUILD_DPH=YES` in `mk/build.mk`. You can skip haddock by setting `HADDOCK_DOCS=NO` in `mk/build.mk`. TODO: Explain how to skip `deepseq`, since it seems to only be used for tests.

{{{#!box info
The table above is maintained manually and can sometimes get out of sync. If in doubt, the primary data source is  the [http://git.haskell.org/ghc.git/blob_plain/HEAD:/packages packages] file in the top-level `ghc.git` repo folder.
}}}